{% extends 'sidebar.html' %}

{% block title %}Manage Users - JTI BAS Dashboard{% endblock %}

{% block header_title %}MANAGE USERS{% endblock %}

{% block content %}
<div class="page-content">
    <h2 style="color: var(--text-color); margin-bottom: 20px;">Daftar Pengguna</h2>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <ul class="flash-messages">
                {% for category, message in messages %}
                    <li class="flash-message {{ category }}">{{ message }}</li>
                {% endfor %}
            </ul>
        {% endif %}
    {% endwith %}

    <div style="margin-bottom: 20px; text-align: right;">
        <a href="{{ url_for('add_user_by_admin') }}" class="monitor-btn"
           style="background-color: #007bff; color: white; padding: 10px 15px; border-radius: 5px; text-decoration: none; font-size: 0.9em; transition: background-color 0.2s ease;">
            <i class="fas fa-user-plus"></i> Tambah Pengguna Baru
        </a>
    </div>

    <div class="table-container" style="background-color: var(--sidebar-bg); border-radius: 8px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.2);">
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="background-color: var(--sidebar-hover); color: var(--sidebar-text);">
                    <th style="padding: 15px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">ID</th>
                    <th style="padding: 15px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Nama</th>
                    <th style="padding: 15px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Email</th>
                    <th style="padding: 15px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Jabatan</th>
                    <th style="padding: 15px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Role</th>
                    <th style="padding: 15px; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.1);">Aksi</th>
                </tr>
            </thead>
            <tbody>
                {% if users %}
                    {% for user in users %}
                    <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                        <td style="padding: 15px; color: var(--sidebar-text);">{{ user.id }}</td>
                        <td style="padding: 15px; color: var(--sidebar-text);">{{ user.nama }}</td>
                        <td style="padding: 15px; color: var(--sidebar-text);">{{ user.email }}</td>
                        <td style="padding: 15px; color: var(--sidebar-text);">{{ user.jabatan }}</td>
                        <td style="padding: 15px; color: var(--sidebar-text);">{{ user.role }}</td>
                        <td style="padding: 15px; text-align: center;">
                            <a href="{{ url_for('manage_user_access', user_id=user.id) }}" class="manage-access-btn"
                               style="background-color: var(--button-bg); color: white; padding: 8px 12px; border-radius: 5px; text-decoration: none; font-size: 0.9em; transition: background-color 0.2s ease;">
                                Kelola Akses Site
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                {% else %}
                    <tr>
                        <td colspan="6" style="padding: 15px; text-align: center; color: var(--sidebar-text);">Tidak ada pengguna yang terdaftar.</td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
